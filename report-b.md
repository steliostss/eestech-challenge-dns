# Ερωτήματα Β & Γ - Αναφορά

#### Ομάδα: DNS

### Ερώτημα Β

Αρχικά στον κώδικα δηλώνονται τα pins για του σχετικούς sensors. Το υποθετημένο layout, και ουσιαστικά ελάχιστο, αναλύεται και στην έκθεση.

Το setup ξεκινάει αρχικοποιοώντας τα I/O μας. Έπειτα, στην κύρια λούπα εκτελούμε κάθε 500 ms τις μετρήσεις μας. 

Αρχικά εντοπίζουμε αν υπάρχει αλλαγή στους proximity sensors ώστε να συμπεράνουμε αν έχουμε μεταβολή στον αριθμό των ατόμων στην αίθουσα (μεταβλητή `persons`).

Τσεκάρουμε αν η αίθουσα έχει μείνει άδεια για παραπάνω από 20 λεπτά, στην οποία περίπτωση απενεργοποιείται ο κλιματισμός της αίθουσας.

Εαν εντοπίζεται αλλαγή ελέγχουμε αν αδειάζει η αίθουσα αυτή τη στιγμή, ώστε να κλείσουμε τα φώτα.

Εαν έχουμε άτομα στην αίθουσα προχωρούμε στις μετρήσεις των υπόλοιπων αισθητήρων. 

Αρχικά εντοπίζεται τυχούσα εντολή από το serial port ώστε να γίνει το απαραίτητο override των αισθητήρων. Αν δηλαδή, υπάρχει εντολή η οποία δεν είναι `AUTO` τότε οι αισθητήρες της φωτεινότητας δεν λαμβάνονται υπόψη και η μέτρηση δεν γίνεται. Εαν η κατάσταση είναι στο **auto** τότε εντοπίζεται το επίπεδο φωτεινότητας στην αίθουσα και έξω ώστε να αποφασιστεί αν θα ανοίξουν τα σκίαστρα ή τα φώτα.

Κάθε 2000 ms (δηλαδή 4 * 500ms που είναι το loop()) ελέγχεται η θερμοκρασία στο χώρο. Η θερμοκρασία μετρίεται πιο αραιά από τα υπόλοιπα καθώς το datasheet του αισθητήρα προτείνει μέγιστη συχνότητα μετρήσεων τα 2 second. Εαν η θερμοκρασία ξεφύγει από τους 25 βαθμούς ελέγχεται η θερμοκρασία του εξωτερικού χώρου ώστε να αποφασισθεί αν θα ανοίξουν τα παράθυρα ή ο κλιματισμός. Οι θερμοκρασίες ελέγχονται για διάστημα 2 βαθμών γύρω από την επιθυμητή καθώς αυτό είναι το σφάλμα που δηλώνει το datasheet του αισθητήρα.

Τέλος, μετριέται ο θόρυβος στην αίθουσα. Για τιμές "φασαρίας" μεγαλύτερες από 255 αυξάνεται αντίστοιχα η ένταση του μικροφώνου του ομιλητή. Έχουμε υποθέσει ότι το μικρόφωνο έχει default ένταση 100 σε μια κλίμακα με range 0- 255. Το διάστημα 255 - 1023 της φασαρίας γίνεται map σε ένα value στο range 0 - 155 το οποίο προστίθεται στην ένταση του μικροφώνου του ομιλητή.

### Ερώτημα Γ

Ο αριθμός των φοιτητών που κάθονται στην αίθουσα δίνεται από την μεταβλητή `persons`. 

Όταν κάποιος μπαίνει και ισχύει $$persons\ \%\ row\_seats= 1$$ τότε μόλις έκατσε κάποιος σε μια νέα σειρά, της οποία ανάβουμε τα φώτα.

Όταν κάποιος βγαίνει και ισχύει $$persons\ \%\ row\_seats = 0$$ τότε μόλις άδειασε μια σειρά, της οποία σβήνουμε τα φώτα.